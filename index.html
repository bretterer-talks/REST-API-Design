<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js â€“ The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/stormpath.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">


		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="color-bar top"></div>
		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Designing a Beautiful REST+JSON API</h1>
					<p>
						<h3>Brian Retterer</h3>
						<h5>brian@stormpath.com</h5>
						<h5>@bretterer</h5>
					</p>
				</section>

				<section>
					<img class="plain" src="images/logo-blue-web.png"/>

					<ul>
						<li class="fragment" data-fragment-index="0">Complete Identity API</li>
						<li class="fragment" data-fragment-index="1">Authentication, Authorization,&nbsp;and User Management for Any Application</li>
						<li class="fragment" data-fragment-index="2">Multi-tenancy Support</li>
						<li class="fragment" data-fragment-index="3">SAML&nbsp;</li>
						<li class="fragment" data-fragment-index="4">Developer Tools, SDK's, and Libraries</li>
					</ul>
				</section>

				<section>
					<h2>HATEOAS</h2>
					<p style="text-align: left">
						<div  style="text-align: left"><strong>H</strong>ypermedia</div>
						<div  style="text-align: left"><strong>A</strong>s</div>
						<div  style="text-align: left"><strong>T</strong>he</div>
						<div  style="text-align: left"><strong>E</strong>ngine</div>
						<div  style="text-align: left"><strong>O</strong>f</div>
						<div  style="text-align: left"><strong>A</strong>pplication</div>
						<div  style="text-align: left"><strong>S</strong>tate</div>
					</p>

					<aside class="notes">
						<p>HATEOAS is giving all information to the user that it needs.</p>
						<p>A consumer knows nothing about your REST api</p>
						<p>Linking to other resources from within the resource</p>
						<p>Everything you want and need should be represented</p>
					</aside>
				</section>

				<section>
					<h2>REST Is Easy</h2>
					<aside class="notes">for consumers it is easy!</aside>
				</section>

				<section>
					<h2>REST Is Fucking Hard!</h2>
					<aside class="notes">
						<p>for providers</p>
						<p>it is a style.  no standards</p>
						set of conventions
					</aside>
				</section>

				<section>
					<h2>Examples from Stormpath</h2>

					<h5>Applications</h5>
					<h5>Directories</h5>
					<h5>Accounts</h5>
					<h5>Groups</h5>
					<h5>Workflows</h5>

					<aside class="notes">

					</aside>

				</section>

				<section>
					<h2>Resources</h2>

					<p>Nouns, Not Verbs</p>

					<p>We are talking about accounts, not about creating accounts.</p>

					<p>Coarse Grained, not fine grained</p>

					<aside class="notes">
						Accounts,  not creating an account
					</aside>

				</section>

				<section>
					<section>
						<h2>Coarse Grained</h2>
						<h5>Tightly Coupled to Action</h5>

						<p style="font-size: 30px">
							<span>/getAccount</span><br />
							<span>/createDirectory</span><br />
							<span>/updateGroup</span><br />
							<span>/verifyAccountEmailAddress</span><br />
						</p>

						<aside class="notes">
							tightly coupled can explode
						</aside>

					</section>

					<section>
						<h2>Coarse Grained</h2>
						<h5>This Smells!</h5>
						<p style="font-size: 30px">
							<span>/getAccount</span><br />
							<span>/getAllAccounts</span><br />
							<span>/searchAccounts</span><br />
							<span>/createDirectory</span><br />
							<span>/createSocialDirectory</span><br />
							<span>/createSamlDirectory</span><br />
							<span>/updateGroup</span><br />
							<span>/updateGroupName</span><br />
							<span>/verifyAccountEmailAddress</span><br />
							<span>/verifyAccountEmailAddressByToken</span><br />
							<span>...</span><br />
						</p>

						<aside class="notes">
							tightly coupled can explode
						</aside>

					</section>
				</section>

				<section>
					<h2>Keep It Simple!</h2>
					<aside class="notes">

					</aside>
				</section>

				<section>
					<section>
						<h2>Two Types of Resources</h2>

						<h6>Collection Resources</h6>
						<h6>Instance Resources</h6>
						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Collection Resources</h2>

						<h5>/applications</h5>
					</section>

					<section>
						<h2>Instance Resources</h2>

						<h5>/applications/123</h5>
					</section>

				</section>

				<section>
					<section>
						<h2>Behavior</h2>

						<h5>GET</h5>
						<h5>PUT</h5>
						<h5>POST</h5>
						<h5>DELETE</h5>
						<h5>HEAD</h5>
					</section>

					<section>
						<h2>Behavior</h2>

						<h5>POST, GET, PUT, DELETE</h5>
						<h3>!= 1:1</h3>
						<h5>Create, Read, Update, Delete</h5>
					</section>

					<section>
						<h2>Behavior</h2>

						<ul>
							<li><strong>GET</strong> = Read</li>
							<li><strong>DELETE</strong> = Delete</li>
							<li><strong>HEAD</strong> = Headers, No Body</li>
						</ul>

						<p><code style="color: #0063FF">PUT</code> and <code style="color: #0063FF">POST</code> can both be used for Create and Update</p>
					</section>

					<section>
						<h2>PUT for Create</h2>

						<p>Identifier is known by Client:</p>
						<pre><code class="hljs" data-trim contenteditable>
PUT /applications/{clientSpecifiedId}

{
	...
}
						</code></pre>
					</section>

					<section>
						<h2>PUT for Update</h2>

						<p>Full Replacement:</p>
						<pre><code class="hljs" data-trim contenteditable>
PUT /applications/{existingId}

{
	"name": "Marvel Comics",
	"description": "We are the best!"
}
						</code></pre>
					</section>

					<section>
						<h2>POST for Create</h2>

						<p>On Parent Resource:</p>
						<pre><code class="hljs" data-trim contenteditable>
POST /applications

{
    "name": "DC Comics",
    "description": "We are the best!"
}

						</code></pre>
						<p>Response</p>

						<pre><code class="hljs" data-trim contenteditable>
201 Created
Location: https://api.stormpath.com/v1/applications/abc123

						</code></pre>
					</section>

					<section>
						<h2>POST for Update</h2>

						<p>On Instance Resource:</p>
						<pre><code class="hljs" data-trim contenteditable>
POST /applications/abc123

{
    "description": "Ok, Marvel is better than us!"
}

						</code></pre>
						<p>Response</p>

						<pre><code class="hljs" data-trim contenteditable>
200 Ok

						</code></pre>
					</section>
				</section>

				<section>
					<h2>Media Types</h2>

					<ul>
						<li>Format Specification + Parsing Rules</li>
						<li>Request: <code style="color:#0063ff">Accept</code> header</li>
						<li>Response: <code style="color:#0063ff">Content-Type</code> header</li>
						<br/>
						<br/>
						<li><code style="color:#0063ff">application/json</code></li>
						<li><code style="color:#0063ff">application/foo+json</code></li>
					</ul>
				</section>

				<section>
					<h1>Design Time</h1>
				</section>

				<section>
					<section>
						<h1>Base URL</h1>
					</section>

					<section>
						<h4>https://api.stormpath.com</h4>
						<p>VS</p>
						<h4>https://www.stormpath.com/developer/service/api/public/rest</h4>
					</section>
				</section>

				<section>
					<section>
						<h1>Versioning</h1>
					</section>

					<section>
						<h4>https://api.stormpath.com/v1</h4>
						<p>VS</p>
						<h4>application/foo+json;application&v=1</h4>
					</section>
				</section>

				<section>
					<h2>camelCase</h2>
					<p>`JS` in `JSON` = JavaScript</p>
					<br/>
					<p>
						account.givenName<br/>
						<strong>NOT</strong> account.given_name
					</p>
					<br/>
					<p>Underscores for properties/functions are unconventional in JavaScript</p>


				</section>

				<section>
					<h2>Date/Time/Timestamp</h2>
					<p>Standard Exists, ISO8601</p>
					<p>
						<h5>Example:</h5>
					<pre><code class="hljs" data-trim contenteditable>

{
    ...
    "createdAt": "2016-03-02T18:14:28.123Z"
    ...
}

					</code></pre>
					</p>
					<br/>
					<p>USE UTC</p>
				</section>

				<section>
					<h2>Header</h2>
					<ul>
						<li><code>Accept</code> header</li>
						<li>Header values are comma delimited in order preference</li>
					</ul>

					<pre><code class="hljs" data-trim contenteditable>

GET /applications/abc123
Accept: application/json, text/plain

					</code></pre>


				</section>

				<section>
					<h2>Resource Extension</h2>
					<p>Adding an extension will override the Accept header</p>

					<pre><code class="hljs" data-trim contenteditable>
/applications/abc123.json
/applications/abc123.csv
/applications/abc123.txt

					</code></pre>


				</section>

				<section>
					<h2>Instance Resource w/ HREF</h2>
					<p>GET /accounts/xyz789</p>

					<pre><code class="hljs" data-trim contenteditable>
200 OK
{
    "href": "https://api.stormpath.com/v1/accounts/xyz789",
	"firstName": "Stan",
	"lastName": "Lee",
	...
}

					</code></pre>


				</section>

				<section>
					<section>
						<h2>Resource Linking</h2>
						<ul>
							<li>Linking is fundamental to scalability</li>
							<li>Tricky in JSON</li>
							<li>XML has XLink, JSON does not</li>
						</ul>

						<aside class="note">scalability is talking about users of api</aside>
					</section>

					<section>
						<h2>Instance Reference</h2>
						<p>GET /accounts/xyz789</p>

						<pre><code class="hljs" data-trim contenteditable>
200 OK
{
    "href": "https://api.stormpath.com/v1/accounts/xyz789",
    "firstName": "Stan",
    "lastName": "Lee",
    "directory": ????,
    ...
}

						</code></pre>
					</section>

					<section>
						<h2>Instance Reference</h2>
						<p>GET /accounts/xyz789</p>

						<pre><code class="hljs" data-trim contenteditable>
200 OK
{
    "href": "https://api.stormpath.com/v1/accounts/xyz789",
    "firstName": "Stan",
    "lastName": "Lee",
    "directory": {
        "href": "https://api.stormpath.com/v1/directories/456def"
    },
    ...
}

						</code></pre>
					</section>

					<section>
						<h2>Collection Reference</h2>
						<p>GET /accounts/xyz789</p>

						<pre><code class="hljs" data-trim contenteditable>
200 OK
{
    "href": "https://api.stormpath.com/v1/accounts/xyz789",
    "firstName": "Stan",
    "lastName": "Lee",
    "groups": {
        "href": "https://api.stormpath.com/v1/accounts/xyz789/groups"
    },
    ...
}

						</code></pre>
					</section>
				</section>

				<section>
					<section>
						<h1>Resource Expansion</h1>
					</section>

					<section>
						<h1>Account and its Directory</h1>
					</section>

					<section>
						<p>GET /accounts/xyz789?expand=directory</p>

						<pre><code class="hljs" data-trim contenteditable>
200 OK
{
    "href": "https://api.stormpath.com/v1/accounts/xyz789",
    "firstName": "Stan",
    "lastName": "Lee",
    "directory": {
        "href": "https://api.stormpath.com/v1/directory/456def",
		"name": "Bad Ass Dudes",
    },
    ...
}

						</code></pre>
					</section>
				</section>

				<section>
					<section>
						<h1>Pagination</h1>
					</section>

					<section>
						<p>Collection Resource support params:</p>
						<ul>
							<li>Offset</li>
							<li>Limit</li>
						</ul>

						<p>.../applications?offset=50&limit=25</p>
					</section>

					<section>
						<pre><code class="hljs" data-trim contenteditable style="max-height:550px;">
200 OK
{
    "href": "https://api.stormpath.com/v1/applications?offset=0&limit=25"
    "offset": 0,
    "limit": 25,
    "first": {
	    "href": "https://api.stormpath.com/v1/applications?offset=0"
    },
    "previous": null,
    "next": {
        "href": "https://api.stormpath.com/v1/applications?offset=25"
    },
    "last": {
        "href": "..."
    },
    "items": [
        {
            "href": "..."
        },
        {
            "href": "..."
        },
        ...
    ]

}
							</code></pre>
					</section>
				</section>

				<section>
					<section>
						<h1>Many to Many</h1>
					</section>

					<section>
						<h2></h2>
						<ul>
							<li>A group can have many accounts</li>
							<li>An account can be in many groups</li>
							<li>Each mapping is a resource:</li>
						</ul>
						<p><code>GroupMembership</code></p>
					</section>

					<section>
						<pre><code class="hljs" data-trim contenteditable style="max-height:550px;">
200 OK
{
    "href":"https://api.stormpath.com/v1/accounts/xyz789/groupMemberships",
    "offset":0,
    "limit":25,
    "size":1,
    "items":[
        {
            "href":"https://api.stormpath.com/v1/groupMemberships/987fds",
            "account":{
                "href":"https://api.stormpath.com/v1/accounts/xyz789"
            },
            "group":{
                "href":"https://api.stormpath.com/v1/groups/567hjk"
            }
        }
    ]
}
						</code></pre>
					</section>
				</section>

				<section>
					<section><h1>Errors</h1></section>
					<section>
						<ul>
							<li>As descriptive as possible</li>
							<li>As much information as possible</li>
							<li>Developers are your customer</li>
						</ul>
					</section>

					<section>
						<p>POST /directories</p>

						<pre><code class="hljs" data-trim contenteditable style="max-height:550px;">
409 Conflict

{
    "status": 409,
    "code": 40924,
    "property": "name",
    "message": "A directory with the name `Deadpool` already exists.",
    "developerMessage": "A directory named `Deadpool` already exists. If you have a stale local cache, please expire it now",
    "moreInfo": "https://docs.stormpath.com/errors/40924"
}
						</code></pre>
					</section>
				</section>

				<section>
					<section><h1>Security</h1></section>
					<section>
						<ul>
							<li>Avoid sessions when possible</li>
							<li>Autorize based on resource, NOT URL!</li>
							<li>Use API Keys instead of Username/Password</li>
							<li>Use Existing Protocols</li>
						</ul>
					</section>
					<section>
						<h2>401 vs 403</h2>

						<ul>
							<li>401 "Unauthorized" really means Unauthenticated</li>
							<li>403 "Forbidden" really means Unauthorized</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>401: you need valid credentials for me to respond to this request.</li>
								<li>403: I understood your credentials, but NO!</li>
							</ul>
						</aside>
					</section>
				</section>

				<section>
					<section><h1>IDs</h1></section>
					<section>
						<ul>
							<li>IDs should be opaque</li>
							<li>Should be globally unique</li>
							<li>Avoid auto inc ids</li>
							<li>Good Candidates: UUID and uniqid()</li>
						</ul>

						<aside class="notes">uniqid() This function does not create random nor unpredictable strings. This function must not be used for security purposes. Use a cryptographically secure random function/generator and cryptographically secure hash functions to create unpredictable secure IDs.</aside>
					</section>
				</section>

				<section>
					<section><h1>Method Overrides</h1></section>
					<section>
						<p>POST /accounts/xyz789?_method=DELETE</p>
					</section>
				</section>

				<section>
					<h1>Designing a Beautiful REST+JSON API</h1>
					<p>
					<h3>Brian Retterer</h3>
					<h5>brian@stormpath.com</h5>
					<h5>@bretterer</h5>
					</p>
				</section>


			</div>

		</div>
		<div class="color-bar bottom">
			<span>Brian Retterer | brian@stormpath.com | @bretterer</span>
			<img class="logo" src="images/logo-blue-web.png" />
		</div>
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
